% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/acf_estimator.R
\name{xacf_fft}
\alias{xacf_fft}
\title{Cross-Autocorrelation Function via Fast Fourier Transform (FFT)}
\usage{
xacf_fft(Y, Tt, lag = NULL, pad = TRUE)
}
\arguments{
\item{Y}{Numeric matrix. A matrix of size \verb{I × Tt} where \code{I} is the number of timeseries (rows)
and \code{Tt} is the number of datapoints (columns). Each row is treated as a separate timeseries.}

\item{Tt}{Integer. Number of datapoints (columns) in \code{Y}, used for consistency check.}

\item{lag}{Optional integer. Maximum lag to compute. If \code{NULL} (default), computes up to \code{Tt - 1}.
If \code{lag = 0}, returns only the lag 0 correlation matrix (Pearson's correlation).}

\item{pad}{Logical (default \code{TRUE}). If \code{TRUE}, zero-pads each timeseries to the next power-of-two
length sufficient for efficient FFT and to avoid circular wrap-around effects.}
}
\value{
A list with:
\describe{
\item{xC}{3D array of dimension \verb{I × I × L}, where \code{L = 2 * (lag - 1) + 1}.
Each slice \code{xC[, , k]} gives the cross-correlation matrix at lag \code{lidx[k]}.
Symmetric property ensured: \code{xC[i, j, k] = xC[j, i, k]}. Diagonal entries contain autocorrelations.}
\item{lidx}{Integer vector of lag indices corresponding to the third dimension of \code{xC},
ranging from \code{-(lag - 1)} to \code{lag - 1}.}
}
}
\description{
Computes full-lag cross-correlation sequences between all pairs of timeseries in \code{Y}
using the Fast Fourier Transform (FFT), efficiently handling multi-dimensional data.
The function supports optional zero-padding for performance and returns results
normalized to unit variance at lag 0 (Pearson correlation at lag 0).
}
\details{
The cross-correlation at lag 0 (\code{lidx == 0}) exactly matches Pearson's correlation matrix.
Autocorrelations (diagonal entries) are normalized such that \code{xC[i, i, lag = 0] = 1}.

If \code{pad = TRUE}, time series are zero-padded to length \code{2^nextpow2(2 * Tt - 1)} before FFT.

The output \code{xC} is fully symmetric across rows and columns for all lags.
}
\examples{
set.seed(123)
Y <- matrix(rnorm(4 * 100), nrow = 4)
result <- xacf_fft(Y, Tt = 100)
dim(result$xC)  # should be 4 x 4 x 199 for default lags
result$lidx[which.max(result$lidx == 0)]  # lag 0

# Verify symmetry at lag 0
lag0_idx <- which(result$lidx == 0)
all.equal(result$xC[, , lag0_idx], t(result$xC[, , lag0_idx]))

# Check that diagonal autocorrelations at lag 0 equal 1
diag(result$xC[, , lag0_idx])

}
